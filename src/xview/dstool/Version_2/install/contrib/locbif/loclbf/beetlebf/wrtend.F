C  -------------------------------------------------------------------
C
C	Copyright (1990-1995) by Alexander Khibnik, Yuri Kuznetsov, and 
C	Eugene Nikolaev.
C
C The Locbif computation code in DsTool is distributed in the hope that it  
C will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty  
C of FITNESS FOR A PARTICULAR PURPOSE.  The software is provided as is without 
C any obligation on the part of Locbif authors, Cornell faculty, 
C Cornell staff or Cornell students to assist in its use, correction, 
C modification or enhancement. 
C
C  -------------------------------------------------------------------

C
      SUBROUTINE WRTEND (IEND,IPR,ISTEP,NG,NFIX,NCAN,EPS,DMOVE)
C     3.05.90.
C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
C*                                                                     *
C*    POPAMMA  WRTEND PEHAHAEHA  BBOA COOEH O ABEPEH*
C*    PAOT POPAMM  BEETLE. BBO HHOO COOEH OPEEET     *
C*    APAMETP  IEND (CM.TEKCT POPAMM  WRTEND).                     *
C*    OCTAHE APAMETP POPAMM WRTEND PEHAHAEH            *
C*    BBOA BMECTE C COOTBETCTBM COOEHEM (T APAMETP        *
C*    OCAH B POPAMME BEETLE).                                     *
C*                                                                     *
C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
C
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*2 (I-N)
      COMMON /WRTE1/ HMIN, HMAX
#if defined(hib)
      IF (IPR .LT. -1) RETURN
          IF (IEND .LT. 0) GOTO 300
C
C.... BBO  COOEH O HOPMAHOM ABEPEH PAOT POPAMM BEETLE.
C
          GOTO (100,110,120,130), IEND
 100      CONTINUE
C
C.... IEND=1:BO KPBO CEAHO AAHHOE CO AOB.
C
            WRITE (NCAN,1000) IEND, ISTEP
            WRITE (NCAN,1040) HMIN, HMAX
            RETURN
 110      CONTINUE
C
C.... IEND=2:BEEHHA EPEMEHHA OCTA CBOEO PAHHOO HAEH
C           (PAHHA TOKA TOHEHA C AAHHO TOHOCT).
C
            WRITE (NCAN,1010) IEND, NG, ISTEP
            WRITE (NCAN,1040) HMIN, HMAX
            RETURN
 120      CONTINUE
C
C.... IEND=3:KPBA AMKHAC C TOHOCT : 5.D0*EPSL.
C
            EPSL  = 5.D0*EPS
            WRITE (NCAN,1020) IEND, EPSL, NFIX, ISTEP
            WRITE (NCAN,1040) HMIN, HMAX
            RETURN
 130      CONTINUE
C
C.... IEND=4:BEEHHA EPEMEHHA OCTA CBOEO PAHHOO HAEH.
C           (PAHHA TOKA TOHEHA C TOHOCT O BEH
C            TEKEO AA).
C
            WRITE (NCAN,1030) IEND, NG, DMOVE, ISTEP
            WRITE (NCAN,1040) HMIN, HMAX
            RETURN
C
 300  CONTINUE
C
C.... COOEH O PEPBAHX PAOT POPAMM BEETLE.
C
      IENDD = -1*IEND
      GOTO (310,320,330,340,350), IENDD
 310  CONTINUE
C
C.... IEND=-1:P AAH BXOHX APAMETPOB OEHA OKA.
C
        WRITE (NCAN,3000) IEND
        RETURN
 320  CONTINUE
C
C.... IEND=-2:EPBA TOKA HA KPBO HE HAEHA.
C
        WRITE (NCAN,3010) IEND
        RETURN
 330  CONTINUE
C
C.... IEND=-3:A BEH O KPBO CTA MEHE MHMAHOO.
C
        ISTEPR = ISTEP-1
        WRITE (NCAN,3020) IEND, NFIX, ISTEPR
        WRITE (NCAN,1040) HMIN, HMAX
        RETURN
 340  CONTINUE
C
C.... IEND=-4:HE HAEHA KACATEHA B EPBO TOKE.
C
        WRITE (NCAN,3030) IEND
        RETURN
 350  CONTINUE
C
C     IEND=-5:PAOTA POPAMM PEPBAHA OOBATEEM.
C
        WRITE (NCAN,3040) IEND, ISTEP
        WRITE (NCAN,1040) HMIN, HMAX
#endif
        RETURN
C
#if defined(hib)
 1000 FORMAT
     A(///1X,120('=')//
     B'    IEND=',I4,'  BO KPBO B OH CTOPOH CEAHO ',I6,
     C' AOB.')
C
 1010 FORMAT
     A(///1X,120('=')//
     B'    IEND=',I4,'  BEEHHA ',I4,' EPEMEHHA OCTA CBOEO',
     C' PAHHOO HAEH'/
     D15X,'PAHHE HAEH KOOPHAT TOHEH C AAHHO TOHOCT'/
     E15X,'BO KPBO B OH CTOPOH CEAHO ',I6,' AOB.')
C
 1020 FORMAT
     A(///120('=')//
     B'    IEND=',I4,'  KPBA AMKHAC C TOHOCT  5.D0*EPS:',G14.5/
     C15X,'HOMEP BEEHHO EPEMEHHO  ',I4/
     D15X,'BO KPBO B OH CTOPOH CEAHO ',I6,' AOB.')
C
 1030 FORMAT
     A(///120('=')//
     B'    IEND=',I4,'  BEEHHA ',I4,' EPEMEHHA OCTA CBOEO',
     C' PAHHOO HAEH'/
     D15X,'PAHHE HAEH KOOPHAT TOHEH C TOHOCT O',
     E' BEH TEKEO AA ',G14.5/
     F15X,'BO KPBO B OH CTOPOH CEAHO ',I6,' AOB.')
C
 1040 FORMAT
     A(/15X,'HAEHE MHMAHOO  AA BO KPBO: ',G14.5
     B /15X,'HAEHE MAKCMAHOO AA BO KPBO: ',G14.5
     C ///120('.'))
C
 3000 FORMAT
     A(///120('*')//
     B'    IEND=',I4,'  P AAH BXOHX APAMETPOB OEHA OKA.'
     C/1X,120('.'))
C
 3010 FORMAT
     A(///120('*')//
     B'    IEND=',I4,'  EPBA TOKA HA KPBO HE HAEHA.'/
     C1X,120('.'))
C
 3020 FORMAT
     A(///120('*')//
     B'    IEND=',I4,'  A BEH O KPBO CTA MEHE MHMAHOO'
     C/15X,'HOMEP KCPOBAHHO EPEMEHHO ',I4
     D/15X,'BO KPBO B OH CTOPOH CEAHO ',I6,' AOB.')
C
 3030 FORMAT
     A(///1X,120('*')//
     B'    IEND=',I4,'  HE HAEHA KACATEHA B EPBO TOKE.'/
     C1X,120('.'))
C
 3040 FORMAT
     A(///1X,120('*')//
     B '    IEND=',I4,'  PAOTA POPAMM PEPBAHA OOBATEEM.'
     C/15X,'BO KPBO B OH CTOPOH CEAHO ',I6,' AOB.')
#endif
      END
