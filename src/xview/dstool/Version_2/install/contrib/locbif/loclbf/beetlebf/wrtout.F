C  -------------------------------------------------------------------
C
C	Copyright (1990-1995) by Alexander Khibnik, Yuri Kuznetsov, and 
C	Eugene Nikolaev.
C
C The Locbif computation code in DsTool is distributed in the hope that it  
C will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty  
C of FITNESS FOR A PARTICULAR PURPOSE.  The software is provided as is without 
C any obligation on the part of Locbif authors, Cornell faculty, 
C Cornell staff or Cornell students to assist in its use, correction, 
C modification or enhancement. 
C
C  -------------------------------------------------------------------

      SUBROUTINE WRTOUT (IWRT,ISTEP,IPR,IT,IDIV,NCAN,NX,NDIMM,X,DFUN)
C     3.05.90.
C     13.11.92
C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
C*                                                                     *
C*    POPAMMA WRTOUT PEHAHAEHA  EAT CTAHAPTHOO POTOKOA *
C*    PAOT POPAMM  BEETLE.                                        *
C*                                                                     *
C*     A P A M E T P :                                               *
C*    ===================                                              *
C*    IWRT  -PHAK EAT TPEEMOO COOEH:                      *
C*                                                                     *
C*           1 -CTAHAPTHA EAT KOOPHAT OEPEHO TOK HA KPBO;*
C*              (EAT HEKOTOPX KOHTPOHX XAPAKTEPCTK KPBO).   *
C*                                                                     *
C*           2 -COOEHE: HE COC HTOHOBCKE TEPA,           *
C*              AAHHA TOHOCT HE OCTHTA.                       *
C*                                                                     *
C*           3 -COOEHE: HE COC HTOHOBCKE TEPA,           *
C*              BPOEHA MATPA ACTHX POBOHX                  *
C*              (HA EAT BAETC MATPA KO).                    *
C*                                                                     *
C*           4 -COOEHE: HE COC HTOHOBCKE TEPA,           *
C*              HE BCEH HAEH HK B OEPEHO TOKE        *
C*              HTOHOBCKOO POHOA.                                *
C*                                                                     *
C*           5 -COOEHE: HE COC HTOHOBCKE TEPA,           *
C*              HE BCEHA MATPA ACTHX POBOHX B             *
C*              OEPEHO TOKE HTOHOBCKOO POHOA.                *
C*                                                                     *
C*           6 -COOEHE: HE HAEH KACATEH BEKTOP, BPOEHA     *
C*              MATPA ACTHX POBOHX (HA EAT BAETC        *
C*              MATPA ACTHX POBOHX).                          *
C*                                                                     *
C*           7 -COOEHE: HE HAEH KACATEH BEKTOP, HE BCEH  *
C*              HAEH HK B TOKE HA KPBO.                    *
C*                                                                     *
C*           8 -COOEHE: HE HAEH KACATEH BEKTOP, HE BCEHA  *
C*              MATPA ACTHX POBOHX B TOKE HA KPBO.         *
C*                                                                     *
C*           9 -COOEHE: TOHEHHA TOKA HE KA K TOKE-POHO.*
C*                                                                     *
C*          10 -COOEHE: POHO O KACATEHO BE A PAH.    *
C*                                                                     *
C*          11 -COOEHE: POHO O HTOH BE A PAH.        *
C*                                                                     *
C*   (12,13,14)-COOEHE: TOHETC TOKA AMKAH.                 *
C*                                                                     *
C*          15 -COOEHE: OOBATEEM PHTO PEEHE EPECTAT   *
C*                         TOHEHH TOK C OOBHHM AOM.        *
C*                                                                     *
C*    ISTEP -CO POEAHHX AOB BO KPBO.                     *
C*    IPR   -PHAK EAT:                                           *
C*           (-2;-1)-BAA POTOKOA OTCCTBET;                      *
C*                0 -HA EAT BATC KOOPHAT TOEK HA KPBO;    *
C*                1 -HA EAT BATC KOOPHAT TOEK HA KPBO    *
C*                   HEKOTOPA KOHTPOHA HOPMA;                 *
C*                2 -HA EAT BATC BCE PH EEH AA OOAM
C*                    HEKOTOPA OOHTEHA HOPMA.            *
C*    IT    -CO HTOHOBCKX TEPA POEAHHX P TOHEH     *
C*           TEKE TOK HA KPBO.                                  *
C*    IDIV  -CO EEH AA OOAM.                               *
C*    NCAN  -HOMEP KAHAA  BBOA PETATOB.                      *
C*    NX    -PAMEPHOCT POCTAHCTBA EPEMEHHX.                       *
C*    NFUN  -PAMEPHOCT BEKTOP-HK.                               *
C*    X     -KOOPHAT TOK (HA KPBO  HEKOTOPO POMETOHO). *
C*    DFUN  -MACCB ACTHX POBOHX.                               *
C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
C*    P MEHEH MAKCMAHOO CA EPEMEHHX- NDIM,              *
C*    HEOXOMO MEHT PAMEPHOCT MACCBA  VMOVE(NDIM)             *
C* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
C
      IMPLICIT REAL*8 (A-H,O-Z)
      IMPLICIT INTEGER*2(I-N)
      include 'beetlebf.dim'
      LOGICAL MAS1(8), MAS2(8)
      DIMENSION X(1), DFUN(NDIM,NX)
      COMMON /ALL1/  XGMN, XGMX
C
      COMMON /LEQV1/ DET1, COND1
      COMMON /CORR1/ DET,  COND, SGNDET
C
      COMMON /WRTO1/ NFIX1, NFIX
      COMMON /WRTO2/ DMOVE1, DMOVE
      COMMON /WRTO3/ COSI1, COSI2, COSI0,COSI3
      COMMON /WRTO4/ EPSC, EPSN
      COMMON /WRTO6/ ITC,IT2
C!!!  COMMON /WRTO7/ VMOVE(25)
      COMMON /WRTO7/ VMOVE(NDIM),VMOVN(NDIM)
C
      DATA MAS1 /' ',' ',' ',' ',' ',' ',' ',' '/,
     A     MAS2 /'+','+','+','+','+','+','+','+'/
C
#if defined(hib)
      IF (IPR .LE. -2) RETURN
          GOTO (100,110,120,130,140,150,160,170,180,190,
     A          200,210,220,230,240), IWRT
 100  CONTINUE
C
C.... IWRT = 1;
C     EAT KOOPHAT OEPEHO TOK HA KPBO.
C
      IF (IPR .LT. 0) RETURN
          IF (IPR .LT. 2 .OR. IDIV .EQ. 0) GOTO 102
C
C.... EAT CA EEH CXOHOO AA OOAM.
C
              WRITE (NCAN,4060) IDIV
              WRITE (NCAN,2010)
              WRITE (NCAN,2000)
 102      CONTINUE
          NT = ISTEP + 1
          WRITE (NCAN,1005) NT, (X(I),I=1,NX)
      IF (IPR .LT. 1) GOTO 11
C
C.... EAT OOHTEHO HOPMA.
C
          WRITE (NCAN,1010)
          WRITE (NCAN,1020)
          IF (DABS(DMOVE1) .NE. DABS(DMOVE)) WRITE (NCAN,1030)  DMOVE1,
     A                                        (MAS2(I),I=1,8),  DMOVE
          IF (DABS(DMOVE1) .EQ. DABS(DMOVE)) WRITE (NCAN,1030)  DMOVE1,
     A                                        (MAS1(I),I=1,8),  DMOVE
          IF (NFIX1 .NE. NFIX)               WRITE (NCAN,1040)  NFIX1,
     A                                        (MAS2(I),I=1,8),  NFIX
          IF (NFIX1 .EQ. NFIX)               WRITE (NCAN,1040)  NFIX1,
     A                                        (MAS1(I),I=1,8),  NFIX
          WRITE (NCAN,1050) IT
          WRITE (NCAN,4090)
          WRITE (NCAN,1052) EPSN
          WRITE (NCAN,1053) EPSC
          WRITE (NCAN,4090)
                               WRITE (NCAN,5000) DET1
          IF (NFIX .NE. NFIX1) WRITE (NCAN,5020) DET
                               WRITE (NCAN,5010) COND1
          IF (NFIX .NE. NFIX1) WRITE (NCAN,5030) COND
          WRITE (NCAN,4090)
          IF (IPR .LT. 2) GOTO 10
              WRITE (NCAN,1060)
              WRITE (NCAN,1070) COSI1
              WRITE (NCAN,1080) COSI0
              WRITE (NCAN,1090) COSI2
              WRITE (NCAN,1095) (VMOVE(I),I=1,NX)
 10       CONTINUE
      WRITE (NCAN,2000)
 11   CONTINUE
      RETURN
 110  CONTINUE
C
C.... IWRT = 2;
C     COOEHE: HE COC HTOHOBCKE TEPA
C                (TPEEMA TOHOCT HE OCTHTA).
C
      IF (IPR .LT. 2)   RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,2020) ITC
          WRITE (NCAN,4090)
          WRITE (NCAN,1052) EPSN
          WRITE (NCAN,1053) EPSC
          WRITE (NCAN,4090)
          WRITE (NCAN,3080) NFIX
          WRITE (NCAN,5000) DET1
          WRITE (NCAN,5010) COND1
          WRITE (NCAN,4090)
          WRITE (NCAN,2030) DMOVE
          WRITE (NCAN,4090)
          WRITE (NCAN,5040)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          RETURN
 120  CONTINUE
C
C.... IWRT = 3;
C     COOEHE: HE COC HTOHOBCKE TEPA
C                (BPOEHA MATPA ACTHX POBOHX).
C
      IF (IPR .LT. 2)   RETURN
          IT = IT - 1
          WRITE (NCAN,2010)
          WRITE (NCAN,3070)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,1050) IT
          WRITE (NCAN,4090)
          WRITE (NCAN,5000) DET1
          WRITE (NCAN,5010) COND1
          WRITE (NCAN,4090)
          WRITE (NCAN,2030) DMOVE
          WRITE (NCAN,3080) NFIX
          WRITE (NCAN,3089)
          DO 125 I=1,NX
             WRITE (NCAN,3090)  (DFUN(I,J), J=1,NX)
 125      CONTINUE
          RETURN
 130  CONTINUE
C
C.... IWRT = 4;
C     COOEHE: HE COC HTOHOBCKE TEPA
C                (HE BCEH HAEH HK B OEPEHO
C                 TOKE HTOHOBCKOO POHOA).
C
      IF (IPR .LT. 2)   RETURN
          IT = IT - 1
          WRITE (NCAN,2010)
          WRITE (NCAN,4000)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,1050) IT
          WRITE (NCAN,2030) DMOVE
          RETURN
 140  CONTINUE
C
C.... IWRT = 5;
C     COOEHE: HE COC HTOHOBCKE TEPA
C                (HE BCEH HAEH ACTHX POBOHX B OEPEHO
C                 TOKE HTOHOBCKOO POHOA).
C
      IF (IPR .LT. 2)   RETURN
          IT = IT - 1
          WRITE (NCAN,2010)
          WRITE (NCAN,4020)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,1050) IT
          WRITE (NCAN,2030) DMOVE
          RETURN
 150  CONTINUE
C
C.... IWRT = 6;
C     COOEHE: HE HAEH KACATEH BEKTOP
C                (BPOEHA MATPA ACTHX POBOHX).
C
      IF (IPR .LT. 2)   RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,4030)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,4090)
          WRITE (NCAN,5000) DET1
          WRITE (NCAN,5010) COND1
          WRITE (NCAN,4090)
          WRITE (NCAN,2030) DMOVE
          WRITE (NCAN,3080) NFIX
          WRITE (NCAN,3089)
          DO 155 I=1,NX
             WRITE (NCAN,3090)  (DFUN(I,J), J=1,NX)
 155      CONTINUE
          RETURN
 160  CONTINUE
C
C.... IWRT = 7;
C     COOEHE: HE HAEH KACATEH BEKTOP
C                (HE BCEH HK B TOKE HA KPBO).
C
      IF (IPR .LT. 2)   RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,4040)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,2030) DMOVE
          RETURN
 170  CONTINUE
C
C.... IWRT = 8;
C     COOEHE: HE HAEH KACATEH BEKTOP
C                (HE BCEH HAEH ACTHX POBOHX
C                 B TOKE HA KPBO).
C
      IF (IPR .LT. 2)   RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,4050)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,2030) DMOVE
          RETURN
 180  CONTINUE
C
C.... IWRT = 9;
C     COOEHE:TOHEHHA TOKA HE KA K TOKE-POHO
C               (A ETC OOAM).
C
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,2060)
          WRITE (NCAN,2070) COSI0
          WRITE (NCAN,2080) COSI1
          WRITE (NCAN,1050) IT
          WRITE (NCAN,2030) DMOVE
          WRITE (NCAN,3050)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          RETURN
 190  CONTINUE
C
C.... IWRT = 10;
C     COOEHE: POHO O KACATEHO BE A PAH.
C
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,2090)
          WRITE (NCAN,3000)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,2030) DMOVE1
          WRITE (NCAN,2040) DMOVE
          WRITE (NCAN,2010)
          WRITE (NCAN,2000)
          RETURN
 200  CONTINUE
C
C.... IWRT = 11;
C     COOEHE: POHO O HTOH BE A PAH.
C
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,3020)
          WRITE (NCAN,3021)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,2010)
          WRITE (NCAN,2000)
          RETURN
 210  CONTINUE
C
C.... IWRT = 12
C     COOEHE: TOHETC TOKA AMKAH.
C
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,3030)
          WRITE (NCAN,3040)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          RETURN
C
C.... IWRT = 13
C
 220  CONTINUE
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,3050)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          RETURN
C
C.... IWRT = 14
C
 230  CONTINUE
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,3060)
          WRITE (NCAN,3010) (X(I),I=1,NX)
          WRITE (NCAN,2010)
          WRITE (NCAN,2000)
          RETURN
 240  CONTINUE
C
C.... IWRT = 15;
C     COOEHE:OOBATEEM PHTO PEEHE EPECTAT TOK
C               (A ETC OOAM).
C
      IF (IPR .LT. 2) RETURN
          WRITE (NCAN,2010)
          WRITE (NCAN,5050)
          WRITE (NCAN,3050)
          WRITE (NCAN,3010) (X(I),I=1,NX)
#endif
          RETURN
C
C.... CCOK OPMATOB.
C
#if defined(hib)
 1005 FORMAT
     A('   NT=',I6,' X=',7(G14.5,1X)/10(15X,7(G14.5,1X)/))
C
 1010 FORMAT
     A(/40X,'HAEH KOHTPOHX APAMETPOB:')
C
 1020 FORMAT
     A(30X,'TEKE HAEH',15X,'POHOPEME HAEH'/)
C
 1030 FORMAT
     A('   A BO KPBO:            ',G14.5,8X,8A1,6X,G14.5)
C
 1040 FORMAT
     A('   HOMEP KCPOBAHHO EPEMEHHO:  ',I6,12X,8A1,6X,I6)
C
 1050 FORMAT
     A('   POEAHO HTOHOBCKX TEPA: ',I6)
C
 1052 FORMAT
     A('   OCTHTA TOHOCT:            ',G15.6)
C
 1053 FORMAT
     A('   TPEEMA   TOHOCT:            ',G15.6)
C
 1060 FORMAT
     A('   HAEH KOCHCA A ME KACATEHO  XOPO:')
C
 1070 FORMAT
     A('   MHMAHOE KOHTPOHOE HAEHE :',G14.5)
C
 1080 FORMAT
     A('   TEKEE HAEHE KOCHCA A   :',G14.5)
C
 1090 FORMAT
     A('   MAKCMAHOE KOHTPOHOE HAEHE:',G14.5)
C
 1095 FORMAT
     A(/'   KOOPHAT KACATEHOO BEKTOPA:'/
     B 10(2X,7(G14.5,1X)/))
C
 2000 FORMAT
     A(1X,120('.'))
C
 2010 FORMAT
     A(1X,120('-'))
C
 2020 FORMAT
     A(/'   POEAHO MAKCMAHOE CO HTOHOBCKX TEPA:',I6/
     B  '   ---------------------------------------------------')
C
 2030 FORMAT
     A('   BEHA PEBAPTEHOO AA:    ',G14.5)
C
 2040 FORMAT
     A('   BEHA TOHEHHOO AA :        ',G14.5)
C
 2050 FORMAT
     A('   CO EEH PEBAPTEHOO AA OOAM:',I6)
C
 2060 FORMAT
     A(/'   TOHEHHA TOKA HE KA K TOKE-POHO.'/
     B  '   --------------------------------------------')
C
 2070 FORMAT
     A('   TEKEE     HAEHE KOCHCA A:',G14.5)
C
 2080 FORMAT
     A('   KOHTPOHOE HAEHE KOCHCA A:',G14.5)
C
 2090 FORMAT
     A(/'    POHO O KACATEHO BE A PAH.'/
     B  '    ----------------------------------------')
C
 3000 FORMAT
     A('    KOOPHAT POHOA PAHHO TOK :')
C
 3010 FORMAT
     A(/10(2X,7(G14.5,1X)/))
C
 3020 FORMAT
     A(/'   POHO O HTOH BE A PAH.'/
     B  '   ------------------------------------')
C
 3021 FORMAT
     A ('   KOOPHAT TOK POHOA:')
C
 3030 FORMAT
     A(/'   TOHETC TOKA AMKAH.'/
     B  '   ---------------------------')
C
 3040 FORMAT
     A(/'   KOOPHAT POHOA TOK AMKAH:')
C
 3050 FORMAT
     A(/'   KOOPHAT TOHEHHO TOK:        ')
C
 3060 FORMAT
     A(/'   KOOPHAT EPBO TOK HA KPBO:  ')
C
 3070 FORMAT
     A(/'   HE COC HTOHOBCKE TEPA- BPOEHA MATPA'
     B /'   ACTHX POBOHX B TOKE C KOOPHATAM:')
C
 3080 FORMAT
     A('   HOMEP KCPOBAHHO EPEMEHHO: ',I6)
C
 3089 FORMAT
     A(/'   MATPA ACTHX POBOHX  DF(I)/DX(J):')
C
 3090 FORMAT
     A (/10(2X,7(G14.5,1X)/))
C
 4000 FORMAT
     A(/'   HE COC HTOHOBCKE TEPA- HE BCEH HAEH'
     B /'   HK B TOKE HTOHOBCKOO POHOA C KOOPHATAM:')
C
 4020 FORMAT
     A(/'   HE COC HTOHOBCKE TEPA- HE BCEH HAEH'
     B /'   ACTHX POBOHX B TOKE HTOHOBCKOO POHOA:   ')
 4030 FORMAT
     A(/'   HE HAEH KACATEH BEKTOP- MATPA ACTHX POBOHX'
     B /'   BPOEHA B TOKE HA KPBO C KOOPHATAM:')
C
 4040 FORMAT
     A(/'   HE HAEH KACATEH BEKTOP- HE BCEH HK'
     B /'   B TOKE HA KPBO C KOOPHATAM:')
C
 4050 FORMAT
     A(/'   HE BCEH KACATEH BEKTOP- HE BCEH HAEH'
     B /'   ACTHX POBOHX B TOKE HA KPBO:')
C
 4060 FORMAT
     A(/   '   CMMAPHOE CO EEH AA OOAM: ',I6/
     B     '   ------------------------------------  ')
C
 4090 FORMAT
     A(1X)
C
 5000 FORMAT
     A('   TEKEE HAEHE OPEETE:   ',G15.6)
C
 5010 FORMAT
     A('   OEHKA OCOBEHHOCT:          ',G15.6)
C
 5020 FORMAT
     A('   (HOBOE HAEHE OPEETE:    ',G15.6,')')
C
 5030 FORMAT
     A('   (HOBA OEHKA OCOBEHHOCT:   ',G15.6,')')
C
 5040 FORMAT
     A('   KOOPHAT OCEHE TOK:      ')
C
 5050 FORMAT
     A(/'   OOBATEEM PHTO PEEHE EPECTAT TOK'
     B /'            (A ETC OOAM)'
     C /'   -----------------------------------------------')
#endif
      END
